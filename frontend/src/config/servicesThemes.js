// NOUVEAU FICHIER : frontend/src/config/servicesThemes.js
// Configuration th√©matique des services avec backend flexible

export const SERVICES_THEMES = {
  evaluate_offer: {
    id: 'evaluate_offer',
    title: 'üéØ √âvaluer une offre d\'emploi',
    description: 'Analysez votre ad√©quation avec une offre sp√©cifique',
    color: '#0ea5e9',
    icon: 'üéØ',
    services: [
      'matching_cv_offre'
    ]
  },
  
  improve_cv: {
    id: 'improve_cv', 
    title: 'üìÑ Am√©liorer mon CV',
    description: 'Optimisez votre CV pour maximiser vos chances',
    color: '#8b5cf6',
    icon: 'üìÑ',
    services: [
      'analyze_cv',
      'cv_ats_optimization'
    ]
  },
  
  apply_jobs: {
    id: 'apply_jobs',
    title: '‚úâÔ∏è Candidater', 
    description: 'Pr√©parez vos candidatures et entretiens',
    color: '#10b981',
    icon: '‚úâÔ∏è',
    services: [
      'cover_letter_advice',
      'cover_letter_generate', 
      'professional_pitch',
      'interview_prep',
      'follow_up_email'
    ]
  },
  
  career_project: {
    id: 'career_project',
    title: 'üöÄ Reconstruire mon projet professionnel',
    description: 'Explorez de nouvelles opportunit√©s de carri√®re',
    color: '#f59e0b',
    icon: 'üöÄ',
    services: [
      'skills_analysis',
      'reconversion_analysis',
      'career_transition',
      'industry_orientation'
    ]
  }
};

// Configuration des services avec m√©tadonn√©es √©tendues
export const ENHANCED_SERVICES_CONFIG = {
  // === TH√àME : √âVALUER UNE OFFRE ===
  matching_cv_offre: {
    id: 'matching_cv_offre',
    title: 'Matching CV/Offre',
    shortTitle: 'Matching CV/Offre',
    coachAdvice: 'D√©couvrez pr√©cis√©ment votre ad√©quation avec cette offre gr√¢ce √† une analyse IA approfondie avec graphiques d√©taill√©s.',
    description: 'Analyse professionnelle de compatibilit√© avec graphiques d√©taill√©s et scores pr√©cis',
    theme: 'evaluate_offer',
    
    // Configuration technique
    requiresCV: true,
    requiresJobOffer: true, 
    requiresQuestionnaire: false,
    allowsNotes: true,
    
    // Configuration affichage
    visible: true,
    featured: false,
    featuredUntil: null,
    
    // M√©tadonn√©es
    difficulty: 'intermediate',
    duration: '5-10 minutes',
    outputType: 'detailed_analysis_with_charts',
    
    // URL et API
    slug: 'matching-cv-offre',
    apiEndpoint: '/api/actions/compatibility'
  },

  // === TH√àME : AM√âLIORER MON CV ===
  analyze_cv: {
    id: 'analyze_cv',
    title: '√âvaluer mon CV',
    shortTitle: 'Analyse CV',
    coachAdvice: 'Obtenez une √©valuation professionnelle de votre CV avec des recommandations concr√®tes pour l\'optimiser.',
    description: 'Analyse d√©taill√©e de votre CV avec recommandations d\'am√©lioration',
    theme: 'improve_cv',
    
    requiresCV: true,
    requiresJobOffer: false,
    requiresQuestionnaire: false,
    allowsNotes: false,
    
    visible: true,
    featured: false,
    featuredUntil: null,
    
    difficulty: 'beginner',
    duration: '3-5 minutes', 
    outputType: 'structured_analysis',
    
    slug: 'analyze-cv',
    apiEndpoint: '/api/actions/analyze-cv'
  },

  cv_ats_optimization: {
    id: 'cv_ats_optimization',
    title: 'Optimisez mon CV pour les ATS',
    shortTitle: 'Optimisation ATS',
    coachAdvice: 'Adaptez votre CV pour qu\'il soit parfaitement lisible par les syst√®mes de tri automatiques des entreprises.',
    description: 'Optimisation de votre CV pour les syst√®mes ATS',
    theme: 'improve_cv',
    
    requiresCV: true,
    requiresJobOffer: true, // Pour adapter aux mots-cl√©s
    requiresQuestionnaire: false,
    allowsNotes: false,
    
    visible: true,
    featured: false,
    featuredUntil: null,
    
    difficulty: 'intermediate',
    duration: '5-8 minutes',
    outputType: 'optimization_guide',
    
    slug: 'cv-ats-optimization', 
    apiEndpoint: '/api/cv/ats-optimize'
  },

  // === TH√àME : CANDIDATER ===
  cover_letter_advice: {
    id: 'cover_letter_advice',
    title: 'Conseils lettre de motivation',
    shortTitle: 'Conseils lettre',
    coachAdvice: 'Recevez des conseils personnalis√©s pour structurer et r√©diger une lettre de motivation percutante.',
    description: 'Conseils personnalis√©s pour votre lettre de motivation',
    theme: 'apply_jobs',
    
    requiresCV: true,
    requiresJobOffer: true,
    requiresQuestionnaire: false,
    allowsNotes: false,
    
    visible: true,
    featured: false,
    featuredUntil: null,
    
    difficulty: 'beginner',
    duration: '3-5 minutes',
    outputType: 'advice_guide',
    
    slug: 'cover-letter-advice',
    apiEndpoint: '/api/cover-letter/advice'
  },

  cover_letter_generate: {
    id: 'cover_letter_generate', 
    title: 'R√©digez votre lettre de motivation',
    shortTitle: 'G√©n√©rer lettre',
    coachAdvice: 'Cr√©ez une lettre de motivation compl√®te et personnalis√©e pr√™te √† √™tre envoy√©e avec votre candidature.',
    description: 'G√©n√©ration compl√®te d\'une lettre de motivation personnalis√©e',
    theme: 'apply_jobs',
    
    requiresCV: true,
    requiresJobOffer: true,
    requiresQuestionnaire: true,
    allowsNotes: true,
    
    visible: true,
    featured: false,
    featuredUntil: null,
    
    difficulty: 'intermediate',
    duration: '8-12 minutes',
    outputType: 'complete_letter',
    
    slug: 'cover-letter-generate',
    apiEndpoint: '/api/cover-letter/generate'
  },

  professional_pitch: {
    id: 'professional_pitch',
    title: 'Pr√©sentez-vous en 30 secondes chrono !',
    shortTitle: 'Pitch',
    coachAdvice: 'D√©veloppez un pitch percutant pour vous pr√©senter efficacement en entretien ou en networking.',
    description: 'Cr√©ation de votre pitch professionnel personnalis√©',
    theme: 'apply_jobs',
    
    requiresCV: true,
    requiresJobOffer: false,
    requiresQuestionnaire: true,
    allowsNotes: true,
    
    visible: true,
    featured: false,
    featuredUntil: null,
    
    difficulty: 'intermediate',
    duration: '6-10 minutes',
    outputType: 'pitch_versions',
    
    slug: 'professional-pitch',
    apiEndpoint: '/api/pitch/generate'
  },

  interview_prep: {
    id: 'interview_prep',
    title: 'Pr√©parez votre entretien d'embauche',
    shortTitle: 'Entretien',
    coachAdvice: 'Pr√©parez-vous m√©thodiquement √† votre entretien avec des questions types et des strat√©gies de r√©ponse.',
    description: 'Pr√©paration compl√®te √† votre entretien d\'embauche',
    theme: 'apply_jobs',
    
    requiresCV: true,
    requiresJobOffer: true,
    requiresQuestionnaire: false,
    allowsNotes: true,
    
    visible: true,
    featured: false,
    featuredUntil: null,
    
    difficulty: 'intermediate',
    duration: '10-15 minutes',
    outputType: 'interview_guide',
    
    slug: 'interview-prep',
    apiEndpoint: '/api/interview/prepare'
  },

  follow_up_email: {
    id: 'follow_up_email',
    title: 'R√©digez un email de relance',
    shortTitle: 'Relance',
    coachAdvice: 'R√©digez un email de relance professionnel pour maintenir le contact apr√®s un entretien ou une candidature.',
    description: 'R√©daction d\'emails de relance professionnels',
    theme: 'apply_jobs',
    
    requiresCV: false,
    requiresJobOffer: true,
    requiresQuestionnaire: false,
    allowsNotes: true,
    
    visible: true,
    featured: false,
    featuredUntil: null,
    
    difficulty: 'beginner',
    duration: '3-5 minutes',
    outputType: 'email_template',
    
    slug: 'follow-up-email',
    apiEndpoint: '/api/followup/generate'
  },

  // === TH√àME : PROJET PROFESSIONNEL ===
  skills_analysis: {
    id: 'skills_analysis',
    title: 'Analysez vos comp√©tences',
    shortTitle: 'Comp√©tences',
    coachAdvice: 'Identifiez vos comp√©tences transf√©rables et d√©couvrez de nouveaux domaines d\'application pour votre profil.',
    description: 'Analyse approfondie de vos comp√©tences et potentiels',
    theme: 'career_project',
    
    requiresCV: true,
    requiresJobOffer: false,
    requiresQuestionnaire: true,
    allowsNotes: true,
    
    visible: true,
    featured: false,
    featuredUntil: null,
    
    difficulty: 'intermediate',
    duration: '8-12 minutes',
    outputType: 'skills_mapping',
    
    slug: 'skills-analysis',
    apiEndpoint: '/api/skills/analyze'
  },

  reconversion_analysis: {
    id: 'reconversion_analysis',
    title: 'D√©couvrez des pistes de reconversion',
    shortTitle: 'Reconversion',
    coachAdvice: 'Explorez une reconversion professionnelle avec une analyse d√©taill√©e des √©tapes et opportunit√©s.',
    description: 'Analyse compl√®te d\'un projet de reconversion professionnelle',
    theme: 'career_project',
    
    requiresCV: true,
    requiresJobOffer: false,
    requiresQuestionnaire: true,
    allowsNotes: true,
    
    visible: true,
    featured: true, // ‚≠ê EXEMPLE D'ACTION MISE EN AVANT
    featuredUntil: '2025-08-31',
    featuredTitle: 'Tester ma compatibilit√© avec le m√©tier de chauffeur de bus',
    
    difficulty: 'advanced',
    duration: '15-20 minutes',
    outputType: 'reconversion_roadmap',
    
    slug: 'reconversion-analysis',
    apiEndpoint: '/api/reconversion/analyze'
  },

  career_transition: {
    id: 'career_transition',
    title: 'Vers quel m√©tier aller ?',
    shortTitle: 'Orientation m√©tier',
    coachAdvice: 'Explorez les m√©tiers correspondant √† vos comp√©tences et √† vos envies.',
    description: 'Analyse d√©taill√©e de votre profil pour proposer des pistes de m√©tiers et les comp√©tences √† d√©velopper.',
    theme: 'career_project',

    requiresCV: true,
    requiresJobOffer: false,
    requiresQuestionnaire: true,
    allowsNotes: true,

    visible: true,
    featured: false,
    featuredUntil: null,

    difficulty: 'intermediate',
    duration: '10-15 minutes',
    outputType: 'career_orientation',

    slug: 'career-transition',
    apiEndpoint: '/api/career/orientation'
  },

  industry_orientation: {
    id: 'industry_orientation',
    title: "Et pourquoi pas un m√©tier dans l'industrie ?",
    shortTitle: 'M√©tier industrie',
    coachAdvice: "Explorez les d√©bouch√©s industriels compatibles avec votre profil.",
    description: "Conseils personnalis√©s pour identifier des m√©tiers industriels.",
    theme: 'career_project',

    requiresCV: true,
    requiresJobOffer: false,
    requiresQuestionnaire: true,
    allowsNotes: true,

    visible: true,
    featured: false,
    featuredUntil: null,

    difficulty: 'intermediate',
    duration: '10-15 minutes',
    outputType: 'industry_orientation',

    slug: 'industry-orientation',
    apiEndpoint: '/api/industry/orientation'
  }
};

// Utilitaires pour le nouveau syst√®me
export const getServicesByTheme = () => {
  const result = {};
  
  Object.values(SERVICES_THEMES).forEach(theme => {
    result[theme.id] = {
      ...theme,
      services: theme.services
        .map(serviceId => ENHANCED_SERVICES_CONFIG[serviceId])
        .filter(service => service && service.visible)
        .sort((a, b) => a.title.localeCompare(b.title))
    };
  });
  
  return result;
};

export const getFeaturedService = () => {
  const now = new Date();
  return Object.values(ENHANCED_SERVICES_CONFIG).find(service => 
    service.featured && 
    service.visible && 
    (!service.featuredUntil || new Date(service.featuredUntil) > now)
  );
};

export const getServiceBySlug = (slug) => {
  return Object.values(ENHANCED_SERVICES_CONFIG).find(service => service.slug === slug);
};

export const getVisibleServices = () => {
  return Object.values(ENHANCED_SERVICES_CONFIG).filter(service => service.visible);
};
